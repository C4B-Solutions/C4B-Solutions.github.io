!function(e){function o(){if(!_)throw new Error("Invoking this method = [geocodeGuestAddress_I_1L] makes sense if guest critical data (location address) was previously loaded into application.");new Promise(function(e){m.geocode({address:_},function(o,n){n==google.maps.GeocoderStatus.OK&&e(o[0].geometry.location)})}).then(function(e){!function(e){var o=a(e.lat(),e.lng()),n=s(h,o,!0),t=r(Number.MAX_VALUE,{person:h+b,address:_});i(n,t),l(n)}(e)},function(e){throw new Error(e)})}function n(){for(var e=0;e<p.length;e++)!function(e,o){var n=s(e.family_description,a(e.family_location_coords.lat(),e.family_location_coords.lng()),!1);i(n,r(o,e)),l(n)}(p[e],e)}function i(e,o){google.maps.event.addListener(e,"click",function(e,o,n){return function(){n.setContent(o),n.open(d,e)}}(e,o,c))}function t(e,o){c.setPosition(o),c.setContent(e?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation."),c.open(d)}function a(e,o){return new google.maps.LatLng(e,o)}function r(e,o){if(e===Number.MAX_VALUE)return'<div class="markerInfoWindowGuest"><div class="inline gravatarGuest" /><div class="inline gravatarInfoGuest"><div class="markerInfo">'+o.person+'</div><div class="adressInfo">'+o.address+"</div></div></div>";for(var n="",i=0;i<o.family_members.length;i++){n+=function(e,o){return'<div class="familyMember" style="top:10px; left:-1px"><div class="gravatarFamilyMember" style="background-image:url(\''+f+"images/family_faces/"+e.friendly_image+'\')" /><div class="gravatarInfo"><div class="markerInfo">'+e.friendly_name+'</div><div class="adressInfo">'+e.friendly_description+"</div></div></div>"}(o.family_members[i])}return'<div class="markerInfoWindow"><div class="family" style="height:'+(11.1*o.family_members.length+5+1.3)+'em"><div class="familyInfo">'+o.family_description+'</div><div class="familyMembers" style="height:'+10*o.family_members.length+'em">'+n+"</div></div></div>"}function s(e,o,n){return new google.maps.Marker({map:d,title:e,position:o,icon:n?u:g,animation:google.maps.Animation.DROP,draggable:!1})}function l(e){d.setCenter(e.getPosition())}var d,c,m,f,g,u,_,p=[],v=!1,y="",h="Me",w=" [ browser thinks that ]",b=" [ this is where I live actually ! ]",I={locationAddressCallback:null};this.__init__=function(e,o,n){return function(e,o,n){_=o,y=n,g=(f=e)+"images/map_location_icons/home.png",u=f+"images/map_location_icons/visitor.png"}(e,o,n)},this.loadMapCriticalData=function(e){return function(e){return function(e){for(var o=_.split("},"),n=o.length,i=0;i<n;i++){for(var t=o[i].replace("{","").replace("}","").split("\n"),a=(t=function(e){for(var o=[],n=-1,i=0;i<e.length;i++)(function(e){return 0!=e.length&&(1!=e.length||13!=e.charCodeAt(0)&&10!=e.charCodeAt(0))})(e[i])&&(o.push(null),o[n+=1]=e[i]);return o}(t)).length,r={family_description:"",family_location_address:"",family_location_coords:{},family_members:[]},s=0;s<a;s++)if(0==s){var l=t[s].split(";");r.family_description=l[0].trim(),r.family_location_address=l[1].trim()}else{var d={friendly_name:"",friendly_description:"",friendly_image:""},c=t[s].split(";");d.friendly_name=c[0].trim(),d.friendly_description=c[1].trim(),d.friendly_image=c[2].trim(),r.family_members.push(d)}p.push(r)}e()}(e)}(e)},this.geocodeAddress=function(e){return function(e){if(0==p.length)throw new Error("Invoking this method = [geocodeAddressCollection_I_1L] makes sense if user critical data was previously loaded into application.");m=new google.maps.Geocoder;var o=[];!function(){for(var e=0;e<p.length;e++){var n=new Promise(function(o){m.geocode({address:p[e].family_location_address},function(e,n){n==google.maps.GeocoderStatus.OK&&o(e[0].geometry.location)})});o.push(n)}}(),Promise.all(o).then(function(o){for(var n=0;n<p.length;n++)p[n].family_location_coords=o[n];v=!0,e()},function(e){throw new Error(e)})}(e)},this.initMap=function(e){return function(e){if(0==p.length||0==v)throw new Error("Invoking this method = [initMap_I_1L] makes sense if user critical data was previously loaded into application and geocoded.");var o={center:{lat:p[0].family_location_coords.lat(),lng:p[0].family_location_coords.lng()},zoom:9,mapTypeId:google.maps.MapTypeId.ROADMAP};d=new google.maps.Map(document.getElementsByClassName(y)[0],o),c=new google.maps.InfoWindow,navigator.geolocation?setTimeout(n,2e3):t(!1,d.getCenter()),e()}(e)},this.initializeGuestLocation=function(e){return function(e){_=e}(e)},this.geocodeGuestAddress=function(){return o()},this.showGuestLocation=function(e){return function(e){navigator.geolocation?(I.locationAddressCallback=e,navigator.geolocation.getCurrentPosition(function(e){var o=a(e.coords.latitude,e.coords.longitude),n=s(h,o,!0);!function(e,o){var n={formatted_address:"",city:{},city_display_name:""};m.geocode({latLng:o},function(o,t){if(t==google.maps.GeocoderStatus.OK)if(o[1]){void 0!==o[0].formatted_address&&(n.formatted_address=o[0].formatted_address);for(var a=0;a<o[0].address_components.length;a++)for(var s=0;s<o[0].address_components[a].types.length;s++)if("administrative_area_level_1"==o[0].address_components[a].types[s]){n.city=o[0].address_components[a];break}void 0!=n.city&&(n.city.short_name===n.city.long_name?n.city_display_name=n.city.short_name:n.city_display_name=n.city.short_name+" "+n.city.long_name);var l=r(Number.MAX_VALUE,{person:h+w,address:n.formatted_address});I.locationAddressCallback(n.formatted_address),i(e,l)}else n.formatted_address="No location found";else n.formatted_address="No location found: "+t})}(n,o),l(n)})):t(!1,d.getCenter())}(e)},this.getProviderName=function(){return"google"},e.googleMapsMapDriver=e.googleMapsMapDriver||this}(window);